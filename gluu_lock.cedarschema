namespace Jans {
    type Context = {
            "network": ipaddr,
            "network_type": String,
            "browser": String, 
            "operating_system": String,
            "device_health": Set<String>,
            "current_time": Long,
            "geolocation": Set<String>,
            "fraud_indicators": Set<String>,
    };
    type StandardClaims = {
        "iss": TrustedIssuer,
        "exp": Long,
        "aud": String,
        "iat": Long,
        "jti": String,
    };
    type Url = {
        "protocol": String,
        "host": String,
        "path": String,
    };
    type email_address = {
        id: String, 
        domain: String,
    }
    entity TrustedIssuer = {
        "issuer_entity_id": Url,
    };
    entity Client  = {
        "client_id": String,
        "iss": TrustedIssuer,
    };
    entity HTTP_Request = {
        "url": Url,
        "header": Set<String>,
        "accept": Set<String>,
    };
    entity Application = {
        "name": String,
        "client": Client,
    };
    entity User = {
        "sub": String,
        "username": String,
        "email": email_address,
        "phone_number": String,
        "role": String,
    };
    entity User in [Role];
    entity Access_token  = {
        "std_claims": StandardClaims,
        "nbf": Long,
        "scope": String,
    };
    entity id_token  = {
        "std_claims": StandardClaims,
        "sub": String,
        "acr": Set<String>,
        "amr": String,
        "azp": String,
        "name": String,
        "email": email_address,
        "phone_number": String,
        "birthdate": String,
        "role": Set<String>,
    };
    entity Userinfo_token  = {
        "sub": String,
        "std_claims": StandardClaims,
        "name": String,
        "email": email_address,
        "phone_number": String,
        "birthdate": String,
        "role": Set<String>,
    };
    action POST appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action GET appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action PUT appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action DELETE appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action HEAD appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action PATCH appliesTo {
        principal: Client,
        resource: HTTP_Request,
        context: Context,
    };
    action Access appliesTo {
        principal: Client,
        resource: Application,
        context: Context,
    };
}
